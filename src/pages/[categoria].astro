---
import '../styles/global.css';
import Layout from '../layouts/Layout.astro';
import {getAllCategories, getDataBySlug} from '../lib/data.js';
import AllProductsList from '../components/AllProductsList/index.jsx';
import Header from '../components/Header';
import Footer from '../components/Footer';
import type { nan } from 'astro:schema';
export interface Category {
  url: string;
  title: string;
  slug: string;
}


export async function getStaticPaths() {
    const allCategorias = await getAllCategories() as Category[];
    
    return await Promise.all(
        allCategorias.map(async ({url, slug, title}) => {
            const products = await getDataBySlug(slug);
            return {
                params: { categoria: url },
                props: {
                    title,
                    products,
                    slug
                }
            };
        })
    );
}

const {categoria} = Astro.params;
const {title, products} = Astro.props;


---

<Layout>
    <Header />
    <AllProductsList products={products} name={title} transition:name="products"/>
    <Footer />
</Layout>
